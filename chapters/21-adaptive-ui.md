# 画面サイズ対応（スマホ/タブレット）

実務では「スマホだけ想定」のUIが通らないことがあります。
タブレットや折りたたみ端末、マルチウィンドウで崩れない設計は、2年目として差が出るポイントです。

---

## この章の目標

- [ ] 画面サイズ対応が必要になるケースを説明できる
- [ ] Composeで「1ペイン/2ペイン」を切り替える設計ができる
- [ ] リスト詳細（master/detail）を大画面で破綻させない
- [ ] 画面回転・マルチウィンドウでも状態を保てる

**所要時間の目安：1.5〜2.5時間**

---

## まず押さえる：何が変わると壊れるか

- 横幅が広い（タブレット/横向き）
- 分割画面（マルチウィンドウ）
- フォントサイズが大きい（アクセシビリティ設定）

「端末が違う」ではなく、**制約が違う**と思うのがコツです。

---

## 基本戦略：1ペイン/2ペイン

### 1ペイン（スマホ）

- 一覧 → 詳細へ遷移
- Navigation中心

### 2ペイン（タブレット）

- 左：一覧、右：詳細
- 遷移より「選択状態」で表現する

---

## 実装方針（Compose）

### Window Size Class を使う（代表例）

画面幅に応じてレイアウトを切り替えます。

#### WindowSizeClassの取り方（例）

```kotlin
// Activity側（例）
val windowSizeClass = calculateWindowSizeClass(this)
setContent {
    App(windowSizeClass = windowSizeClass)
}
```

`calculateWindowSizeClass` を使うための依存関係は、Material3のWindow Size Classを追加します（プロジェクト構成により差分あり）。

```kotlin
if (isExpanded) {
    MemoTwoPane(
        memos = memos,
        selectedId = selectedId,
        onSelect = viewModel::selectMemo
    )
} else {
    MemoOnePane(
        memos = memos,
        onOpenDetail = { id -> navController.navigate("detail/$id") }
    )
}
```

ポイント：

- 大画面では「選択状態」をStateで持つ
- 小画面では「遷移」をNavigationで表現する

#### 状態の置き場所（事故らない）

2ペインで迷子になりやすいのは「選択状態」です。おすすめは以下です。

- 選択中のIDは `ViewModel` の `uiState` に入れる（回転やプロセス死でも復元しやすい）
- 画面内ローカルに置く場合は `rememberSaveable` を使う（最小構成）

---

## よくある落とし穴

- 横幅が増えたのに、固定幅のUIでスカスカ/読みにくい
- 2ペインで「戻る」の意味が壊れる（選択解除？画面終了？）
- 回転で選択状態が消える（Stateの置き場が悪い）

---

## 実務Tips（意外と見落とす）

- 文字が長い言語でも崩れないか（i18n）
- フォントサイズ最大でも読めるか（a11y）
- 2ペイン時は「詳細未選択」の空状態を用意する
- 端末回転だけでなく、分割画面でも確認する

---

## ミニ課題

シンプルメモアプリを想定し、以下を実装/設計してください。

- 画面幅が広いときは「一覧+詳細」の2ペインにする
- 詳細が未選択ならプレースホルダを表示する
- 回転しても選択中のメモが維持される

---

## AIに聞いてみよう

```
【質問】
Composeでタブレット対応をしたい。
一覧+詳細の2ペイン設計で、状態管理とNavigationの責務分担を提案して。
```
