# Unit 5: データ永続化（ガイド）

Unit 5では、アプリの価値を支える **永続化（Room/DataStore）** を扱います。アプリを閉じてもデータが残る状態を作ります。

---

## 前提

- Unit 4まで完了し、Repository経由でデータを扱える

## この章でできるようになること

- RoomでCRUDを実装し、Repositoryの裏側に隠せる
- DataStoreで設定（並び替えなど）を保存できる
- オフラインでも破綻しない状態設計ができる

---

## このユニットでやること（レッスン）

- 永続化：[データ保存（Room / DataStore）](chapters/11-storage.md)

---

## チェックポイント（完了条件）

- [ ] アプリ再起動後もメモが残る
- [ ] 取得/保存/更新/削除がRepository越しに呼べる
- [ ] エラー時（DB例外/マイグレーション等）の扱い方針がある

---

## 演習

- [ ] メモの保存先をRoomにし、一覧がDBを監視して更新されるようにする
- [ ] 並び替え条件をDataStoreに保存し、次回起動でも復元する
- [ ] DB例外が起きたときのUI（エラー表示/再試行/復旧）を考える

---

## AIに聞いてみよう

### 質問テンプレ（コピペ）

```text
【前提】
このユニットを進めています（この章のコンテキストは共有済み）。

【いま困っていること】
（例：どの順で進める？ / 演習をチケットに分けたい / 設計の判断をしたい）

【今の状態】
- どこまで終わったか：
- 詰まっている箇所（レッスン/チェックポイント）：
- 関連する実装やログ（必要なら）：

【欲しい回答】
- 次にやること（優先順）
- 理由
- 完了の判断基準（チェックリスト）
```

### 質問例

```text
【質問】
このユニットのレッスンを、週6時間前提で「今週のタスク」に分解して。
読む/実装/動作確認/PRの順で、最小セットを提案して。
```

```text
【質問】
このユニットのチェックポイントを満たせているか、私の現状（説明/スクショ/差分）からレビューして。
足りない点と次の一手も出して。
```

```text
【質問】
演習をPR単位に分割して。各PRの目的、受け入れ条件、確認手順（スクショ/テスト）も書いて。
```

---

## ふりかえり

- 「DBを直接UIから触らない」理由は何？
- DataStoreは、何を保存すべき/すべきでない？
- オフラインで壊れやすいポイントはどこ？

---

## 次の章

次は [データ保存（Room / DataStore）](chapters/11-storage.md) に進み、永続化を入れましょう。
